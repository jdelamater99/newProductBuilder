<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <title>Homepage Compare 300x200</title>
        
    <link type="text/css" href="../bin/builder.css" rel="stylesheet" />
        
    <script src="../bin/jquery.js" type="text/javascript"></script>
    <script src="../bin/builderFunctions.js" type="text/javascript"></script>
        
    <script>
        // exempt from field check
        var excludes = ["vidUrl", "vidTriggerUrl", "tracking"];
        
        function init() {
            var adOutput = '<!-- DESKTOP: COMPARE CAR AD (300x200) --> <link href="//fonts.googleapis.com/css?family=Roboto:400,300,700,500" rel="stylesheet" type="text/css"> <link rel="stylesheet" type="text/css" media="screen" href="//www.autotraderstatic.com/0_0_0/bundles/base.css" /> <style type="text/css"> #ia-compare-imp {position: relative; right: 0; top: 0; z-index: -1; } a {font-size: 15px; color: #505fbb; text-decoration: none; } a:hover {color: #000000; } a > img {border: none; } #ia-compare-image {margin: 0; z-index: 10010; } #ia-compare-model {position: relative; top: -30px; color: #666; } #ia-compare-logo {float: left; padding-right: 10px; margin-right: 10px; border-right: 1px solid #ccc; } #ia-compare-sponsor {color: #999; } </style>';
            
            adOutput += '\n' + '<!-- Sponsor Link -->';
            adOutput += '\n' + '<a href="%%CLICK_URL_ESC%%' + el(pageFormFields[1].id).value + '" target="_blank">';

            adOutput += '\n\t' + '<!-- Sponsor Image -->';
            adOutput += '\n\t' + '<img id="ia-compare-image" src="' + el(pageFormFields[2].id).value + '" style="width:100%"/>';
            adOutput += '\n' + '</a>';
            adOutput += '\n' + '<div id="ia-compare-model" style="display:none">';
            
            adOutput += '\n\t' + '<!-- Sponsor Model -->';
            adOutput += '\n\t' + el(pageFormFields[3].id).value;
            adOutput += '\n' + '</div>';
            
            adOutput += '\n' + '<!-- Sponsor Logo -->';
            adOutput += '\n' + '<img id="ia-compare-logo" src="' + el(pageFormFields[4].id).value + '" />';
            adOutput += '\n' + '<div id="ia-compare-sponsor">';
            
            adOutput += '\n\t' + '<!-- Sponsor Brand -->';
            adOutput += '\n\t' + el(pageFormFields[5].id).value;
            adOutput += '\n' + '</div>';
            adOutput += '\n\t' + '<div id="ia-compare-link">';
            
            adOutput += '\n\t' + '<!-- Sponsor Link -->';
            adOutput += '\n\t' + '<a href="%%CLICK_URL_ESC%%' + el(pageFormFields[1].id).value + '" target="_blank">';
            adOutput += '\n\t\t' + el(pageFormFields[6].id).value + ' <span class="atcui-icon atcui-externalLink"></span>';
            adOutput += '\n\t' + '</a>';
            adOutput += '\n' + '</div>';
            adOutput += '\n' + '<div class="atcui-clearboth"></div>';
            
            adOutput += '\n' + '<!-- Impression Tag -->';
            adOutput += '\n' + unHTMLEntities(el(pageFormFields[0].id).value);

                        
            if (formCompetion() != false){
                output = unHTMLEntities(adOutput);
                el("output").innerHTML = output;
            } else {
                el("output").innerHTML = "Fill out all the fields to generate the tag";   
            }
        }
        
        var pageFormFields = [
        /* 0 */    {id: "tracking", title: "Tracking Tags", tag: "tracking", type: "bin/id_tag.png"},
            
        /* 1 */    {id: "sponsorLink", title: "Sponsor Link", tag: "sponsorLink", type: "bin/id_url.png"},
        /* 2 */    {id: "sponsorImg", title: "Sponsor Image (300x150)", tag: "sponsorImg", type: "bin/id_image.png"},
        /* 3 */    {id: "sponsorModel", title: "Sponsor Model", tag: "sponsorModel", type: "bin/id_text.png"},
        /* 4 */    {id: "sponsorLogo", title: "Sponsor Logo (123x30 max)", tag: "sponsorLogo", type: "bin/id_image.png"},
        /* 5 */    {id: "sponsorBrand", title: "Sponsor Brand", tag: "sponsorBrand", type: "bin/id_text.png"},
        /* 6 */    {id: "sponsorLinkTxt", title: "Link Text", tag: "sponsorLinkTxt", type: "bin/id_text.png"}
        ];
        
        var defaultValues = [
            {id: "tracking", value: '<IMG SRC="https://ad.doubleclick.net/ddm/trackimp/XXXX.XXXX.AUTOTRADER.COM/XXXX.XXXX;dc_trk_aid=XXXX;dc_trk_cid=XXXX;ord=%%CACHEBUSTER%%;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?" BORDER="0" HEIGHT="1" WIDTH="1" ALT="Advertisement"><SCRIPT language=\'JavaScript1.1\' SRC="https://ad.doubleclick.net/ddm/trackimpj/XXXX.XXXX.AUTOTRADER.COM/XXXX.XXXX;dc_trk_aid=XXXX;dc_trk_cid=XXXX;ord=%%CACHEBUSTER%%;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?"><\/SCRIPT>'},
            {id: "sponsorLink", value: "https://ad.doubleclick.net/ddm/trackclk/XXXX.XXXX.AUTOTRADER.COM/XXXX.XXXX;dc_trk_aid=XXXX;dc_trk_cid=XXXX;dc_lat=;dc_rdid=;tag_for_child_directed_treatment="},
            {id: "sponsorImg", value: "//content.autotrader.com/content/dam/autotrader/ads/homepage/compare/{YEAR}/dec/CompareHP_{MODEL}.jpg"},
            {id: "sponsorModel", value: "{YEAR} {BRAND} {MODEL}"},
            {id: "sponsorLogo", value: "//content.autotrader.com/content/dam/autotrader/ads/homepage/compare/{YEAR}/12/{BRAND}-logo_48x30.png"},
            {id: "sponsorBrand", value: "Sponsored by {BRAND}"},
            {id: "sponsorLinkTxt", value: "Compare this car to others"},
        ];
        
        function buildForm() {
            var formOutput = "";
            for (i=0; i<pageFormFields.length; i++){
                if (pageFormFields[i].id == "tracking")
                    formOutput += "<div><div class=\"title\">"+pageFormFields[i].title+": </div><div><textarea class='defaultInput' id=\""+pageFormFields[i].id+"\" ></textarea></div> <div><img class='idTA' src='../"+ pageFormFields[i].type +"' /></div> </div>\n";    
                else 
                    formOutput += "<div><div class=\"title\">"+pageFormFields[i].title+": </div><div class=\"input\"><input class='defaultInput' id=\""+pageFormFields[i].id+"\" type=text /></div> <div><img src='../"+ pageFormFields[i].type +"' /></div> </div>\n";
            } 
            
            el("formDiv").innerHTML = formOutput;
            
            // default values for testing
            if (params["test"]){
                for (i=0; i<defaultValues.length; i++) {
                    el(defaultValues[i].id).value = defaultValues[i].value;
                }
            }
            
            inputFocus();
        }
        
        $( buildForm );
    </script>
    
    </head>
    <body>
    	<form name="adBuilder">
            <div>
            
            <div id="formDiv"></div>
            
    		
    		<div>
                <br />
                <input id="submitBtn" type=button value="Generate Tag" onmousedown="init();" />
                <input id="clearBtn" type=button value="Clear Form" onmousedown="clearform();" />
            </div>
        </form>
    	
    	<p>
    		<textarea id="output"></textarea>
    	</p>
    </body>
</html>